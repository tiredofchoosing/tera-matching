(function(){function t(t,s=!0){s&&saveData(a,a.selectedIndex),y.forEach((t=>{t.sortingCriteria=a.value,t.updateChartData()}))}function s(t,s=!0){s&&saveData(l,l.checked,!1),y[1].disableFirstValue=l.checked,null!=t&&y[1].updateChartData()}function e(){y.forEach((t=>{t.refreshDatasets(),t.updateChartData()}))}function o(){s(null,!1),t(null,!1)}function i(){setTimeout((()=>y.forEach((t=>t.updateStyles()))),100)}const l=document.getElementById("hideNoGuild"),a=document.getElementById("selectStatsSort"),r=document.getElementById("clearNavigation"),n=document.getElementById("content"),h=[l],c=[a],d=["classChart","guildChart"],y=[],u=0;class p{chart=null;initData=[];labels=[];values=[];styles={};chartOptions={};maxChartLabelWidth=150;disableFirstValue=!1;sortingCriteria="default";constructor(t){this.name=t,this.canvas=document.getElementById(t),this.context=this.canvas.getContext("2d"),this.rootStyles=window.getComputedStyle(document.documentElement),this.refreshDatasets(),this.#t(),this.#s(),this.#e(),this.#o()}initChart(){null==this.chart&&(this.chart=new Chart(this.context,{type:"bar",data:{labels:this.labels,datasets:[{data:this.values,label:this.canvas.dataset.barLabel,borderWidth:1,backgroundColor:this.styles.barBgColor,borderColor:this.styles.barBorderColor}]},options:this.chartOptions}))}refreshDatasets(){const t=document.getElementById(this.name+"DataContainer").dataset,s=t.labels?.split(",")??[],e=t.values?.split(",")??[];this.labels=s,this.values=e,this.initData=s.map(((t,s)=>({label:t,value:e[s]})))}updateChartData(){this.#i(),this.#t(),this.#o(),null!=this.chart&&(this.chart.data.datasets[0].data=this.values,this.chart.data.labels=this.labels,this.chart.update())}updateStyles(){null!=this.chart&&(this.#s(),this.#l(),this.chart.update())}#e(){Chart.defaults.maintainAspectRatio=!1,Chart.defaults.plugins.legend.display=!1;const t=this.#a(),s=function(s){const e=this.getLabelForValue(s);return t(e)};this.chartOptions={indexAxis:"y",scales:{x:{beginAtZero:!0,grid:{color:this.styles.gridColor},border:{color:this.styles.axisColor},ticks:{precision:0,stepSize:1,color:this.styles.fontColor,font:{size:this.styles.fontSize,family:this.styles.fontFamily}}},y:{grid:{color:this.styles.gridColor},border:{color:this.styles.axisColor},ticks:{color:this.styles.fontColor,font:{size:this.styles.fontSize,family:this.styles.fontFamily},callback:s}}},plugins:{title:{display:!0,text:this.canvas.dataset.title,color:this.styles.fontColor,font:{size:this.styles.titleFontSize,family:this.styles.fontFamily,weight:600},padding:{top:0,bottom:8}},tooltip:{displayColors:!1,backgroundColor:this.styles.tooltipBgColor,titleColor:this.styles.fontColor,titleFont:{size:this.styles.fontSize,family:this.styles.fontFamily,weight:600},bodyColor:this.styles.fontColor,bodyFont:{size:this.styles.fontSize,family:this.styles.fontFamily},borderColor:this.styles.tooltipBorderColor,borderWidth:1}}}}#t(){this.labels.length>0&&this.values.length>0?this.canvas.parentNode.hidden=!1:this.canvas.parentNode.hidden=!0}#o(){this.canvas.parentNode.style.height=30*this.labels.length+65+50+"px"}#s(){this.styles={fontColor:this.rootStyles.getPropertyValue("--chart-font-color").trim(),fontFamily:this.rootStyles.getPropertyValue("--chart-font-family").trim(),fontSize:this.rootStyles.getPropertyValue("--chart-font-size").trim(),titleFontSize:this.rootStyles.getPropertyValue("--chart-title-font-size").trim(),axisColor:this.rootStyles.getPropertyValue("--chart-axis-color").trim(),gridColor:this.rootStyles.getPropertyValue("--chart-grid-color").trim(),barBgColor:this.rootStyles.getPropertyValue("--chart-bar-bg-color").trim(),barBorderColor:this.rootStyles.getPropertyValue("--chart-bar-border-color").trim(),tooltipBgColor:this.rootStyles.getPropertyValue("--chart-tooltip-bg-color").trim(),tooltipBorderColor:this.rootStyles.getPropertyValue("--chart-tooltip-border-color").trim()}}#l(){null!=this.chart&&(this.chart.options.scales.x.grid.color=this.styles.gridColor,this.chart.options.scales.x.border.color=this.styles.axisColor,this.chart.options.scales.x.ticks.color=this.styles.fontColor,this.chart.options.scales.x.ticks.font={size:this.styles.fontSize,family:this.styles.fontFamily},this.chart.options.scales.y.grid.color=this.styles.gridColor,this.chart.options.scales.y.border.color=this.styles.axisColor,this.chart.options.scales.y.ticks.color=this.styles.fontColor,this.chart.options.scales.y.ticks.font={size:this.styles.fontSize,family:this.styles.fontFamily},this.chart.options.plugins.title.color=this.styles.fontColor,this.chart.options.plugins.title.font={size:this.styles.titleFontSize,family:this.styles.fontFamily},this.chart.options.plugins.tooltip.backgroundColor=this.styles.tooltipBgColor,this.chart.options.plugins.tooltip.borderColor=this.styles.tooltipBorderColor,this.chart.options.plugins.tooltip.titleColor=this.styles.fontColor,this.chart.options.plugins.tooltip.titleFont={size:this.styles.fontSize,family:this.styles.fontFamily},this.chart.options.plugins.tooltip.bodyColor=this.styles.fontColor,this.chart.options.plugins.tooltip.bodyFont={size:this.styles.fontSize,family:this.styles.fontFamily},this.chart.data.datasets[0].backgroundColor=this.styles.barBgColor,this.chart.data.datasets[0].borderColor=this.styles.barBorderColor)}#a(){const t=this.styles.fontSize+"px",s=this.styles.fontFamily,e=Math.min(this.maxChartLabelWidth,Math.floor(this.canvas.offsetWidth/3));return function(o){const i=document.createElement("span");i.style.fontSize=t,i.style.fontFamily=s,i.style.whiteSpace="nowrap",i.style.visibility="hidden",i.style.position="absolute",document.body.appendChild(i);let l=o,a=0;for(i.textContent=o;i.offsetWidth>e;)a++,l=o.substring(0,o.length-a)+"...",i.textContent=l;return document.body.removeChild(i),l}}#i(){let t=this.initData.map((t=>t.label)),s=this.initData.map((t=>t.value));if(this.disableFirstValue&&(t.shift(),s.shift()),"default"!==this.sortingCriteria){const e=t.map(((t,e)=>({label:t,value:s[e]})));e.sort(((t,s)=>{const e=t.label.toLowerCase(),o=s.label.toLowerCase(),i=t.value,l=s.value;switch(this.sortingCriteria){case"labelDesc":return o.localeCompare(e);case"labelAsc":return e.localeCompare(o);case"valueDesc":return l-i;case"valueAsc":return i-l}})),t=e.map((t=>t.label)),s=e.map((t=>t.value))}this.labels=t,this.values=s}}d.forEach((t=>y.push(new p(t)))),document.fonts.ready.then((()=>{y.forEach((t=>t.initChart()))})),a.addEventListener("change",t),l.addEventListener("change",s),n.addEventListener("contentUpdated",e),document.addEventListener("styleChanged",i),r.addEventListener("click",(function(){a.selectedIndex=u,t(null,!0)})),c.forEach((t=>t.selectedIndex=loadData(t)??t.selectedIndex)),h.forEach((t=>{const s=loadData(t,!1);null!=s&&(t.checked="true"===s)})),o()})();